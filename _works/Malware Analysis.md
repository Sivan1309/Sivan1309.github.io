---
title: Malware Research & Hands-On Lab Analysis â€” Static, Dynamic & Reverse Engineering of PDF, PE and DLL Samples
date: 2024-02-23
---

# Malware Research & Hands-On Lab Analysis â€” Static, Dynamic & Reverse Engineering of PDF, PE and DLL Samples

---

## Executive Summary

This project documents a hands-on malware research investigation covering static analysis, dynamic analysis, packed binary inspection, DLL behavioral analysis, and reverse engineering across multiple suspicious samples including PDFs, PE executables, and DLL files.

The objective of this project was to simulate a real-world malware triage and research workflow â€” starting from file triage and structure inspection through behavioral execution, capability mapping, and MITRE ATT&CK alignment â€” using industry malware analysis tooling and controlled sandbox environments.

The outcome includes malicious sample confirmation, behavioral capability mapping, persistence discovery, network indicators, and reverse-engineered execution traits.

This project demonstrates applied skills in:

- Malware static & dynamic analysis
- Packed binary investigation
- PDF malware inspection
- DLL behavioral analysis
- Registry & persistence tracing
- Network traffic analysis
- Capability detection using CAPA
- MITRE ATT&CK mapping
- Reverse engineering fundamentals

---

## Investigation Objective

The objective was not just classification â€” but **evidence-driven determination of malicious behavior** using:

- Static structure analysis
- Packed binary inspection
- Behavioral execution tracing
- Registry & persistence validation
- Network traffic analysis
- Capability mapping
- Reverse engineering verification

Every conclusion is supported by tool output evidence and analyst interpretation.

---

## Investigation Methodology

The workflow followed a layered analyst investigation model:

```

Triage
â†’ Static Structure Inspection
â†’ Indicator Extraction
â†’ Packing Detection
â†’ Unpacking
â†’ Behavioral Execution
â†’ Host Impact Measurement
â†’ Network Impact Measurement
â†’ Capability Mapping
â†’ Reverse Engineering Validation
â†’ Detection Translation

````

---

## Lab Environment

Analysis performed in isolated malware lab VMs.

- REMnux analysis distro
- Windows malware analysis VM
- VirtualBox isolated network
- Snapshot rollback enabled
- Controlled execution only
- Sandbox validation used for network behavior

---

## Sample Scope

| Sample          | Type   | Investigation Focus                  |
|-----------------|----------|--------------------------------------|
| CW_sample1â€“3    | PDF      | Embedded script & execution triggers |
| suspicious.file | PE EXE   | Packed malware behavior              |
| malsample.dll   | DLL      | Persistence & service abuse          |

---

# Phase 1 â€” Malicious PDF Investigation

## Analyst Goal

Determine whether PDFs contain execution triggers or embedded scripts **without executing them**.

---

## Raw Structure Inspection

**Tool:** SciTE  
**Purpose:** Inspect encoded streams safely

<img width="1488" height="812" alt="image" src="https://github.com/user-attachments/assets/6ab8dfc6-268f-4ff2-befd-71fd5c31d007" />


**Observation**

Encoded object streams present â†’ requires structural scanning.

**Decision:** Escalate to structural indicator scan.

---

## Structural Trigger Scan

**Tool:** PDFiD

```bash
pdfid.py CW_sample2.pdf
````

ðŸ“¸ Evidence â€” PDFiD Trigger Indicators
`screenshots/pdfid_triggers.png`

**Evidence**

* /JavaScript present
* /OpenAction present
* /AA present

**Interpretation**

Document executes code on open â†’ no user action required.

**Conclusion**

High-risk execution behavior.

---

## Object Decoding Validation

**Tool:** PDF-Parser

ðŸ“¸ Evidence â€” Decoded JavaScript Object
`screenshots/pdf_parser_js.png`

Decoded object confirmed embedded JavaScript execution logic.

---

## PDF Verdicts

| Sample  | Verdict   | Reason                    |
| ------- | --------- | ------------------------- |
| Sample1 | Benign    | No execution triggers     |
| Sample2 | Malicious | JS + OpenAction           |
| Sample3 | Malicious | External JS communication |

---

# Phase 2 â€” Packed Executable Analysis

## Analyst Goal

Determine whether binary is packed and hiding malicious logic.

---

## PE Structure Inspection

**Tool:** PEView

ðŸ“¸ Evidence â€” UPX Sections Present
`screenshots/pe_upx_sections.png`

**Evidence**

* UPX0 / UPX1 sections
* Packed layout signature

**Decision:** Confirm packer.

---

## Packer Identification

**Tool:** Exeinfo PE

ðŸ“¸ Evidence â€” UPX Signature Detection
`screenshots/exeinfo_upx.png`

Confirmed packed with UPX.

---

## Controlled Unpacking

```bash
upx -d suspicious.file
```

ðŸ“¸ Evidence â€” Successful Unpack
`screenshots/upx_unpack_success.png`

---

## IOC Extraction Post-Unpack

**Tool:** Pestudio

ðŸ“¸ Evidence â€” Blacklisted Imports & Strings
`screenshots/pestudio_blacklist.png`

**Indicators**

* Suspicious API imports
* Registry manipulation calls
* Malicious strings
* Injection-capable functions

**Verdict:** Malicious executable confirmed.

---

# Phase 3 â€” DLL Malware Behavioral Analysis

## Analyst Goal

Determine persistence and execution behavior of DLL payload.

---

## Controlled DLL Execution

```bash
rundll32.exe malsample.dll,Install
```

ðŸ“¸ Evidence â€” DLL Execution via rundll32
`screenshots/rundll32_execution.png`

---

## Registry Impact Measurement

**Tool:** Regshot (before/after diff)

ðŸ“¸ Evidence â€” Registry Diff Output
`screenshots/regshot_diff.png`

**Evidence**

* New service created
* Persistence registry keys written
* Service DLL path inserted

**Persistence Artifact**

```
HKLM\SYSTEM\ControlSet001\Services\IPRIP\Parameters\ServiceDll
```

**Conclusion**

Boot persistence established.

---

# Phase 4 â€” Network Behavior Analysis

**Tool:** Wireshark + Sandbox PCAP

ðŸ“¸ Evidence â€” DNS Beacon Queries
`screenshots/wireshark_dns.png`

**Observed**

* DNS beaconing
* HTTP GET callbacks
* Periodic traffic interval
* Mutex creation event

**Interpretation**

C2 beacon behavior pattern.

---

# Phase 5 â€” Capability Mapping

**Tool:** CAPA

ðŸ“¸ Evidence â€” CAPA Capability Matches
`screenshots/capa_capabilities.png`

**Capabilities Detected**

* Service persistence
* Registry modification
* Network communication
* Execution delay logic

---

# MITRE ATT&CK Mapping

ðŸ“¸ Evidence â€” ATT&CK Technique Mapping
`screenshots/mitre_mapping.png`

**Mapped behaviors**

* Persistence â€” Service install
* Registry modification
* Command execution
* Beacon communication

---

# Phase 6 â€” Reverse Engineering Validation

## Export Table Analysis

ðŸ“¸ Evidence â€” DLL Export Functions
`screenshots/dll_exports.png`

Total exports: **5**

---

## Execution Delay Behavior

ðŸ“¸ Evidence â€” Sleep Call Graph
`screenshots/sleep_graph.png`

Sleep parameter:

```
0xEA60 = 60000 ms
```

Interpretation: Sandbox evasion delay.

---

# Analyst Decision Log

* Encoded PDF streams detected â†’ escalated to structural scan
* Execution triggers found â†’ object decoding performed
* UPX sections detected â†’ unpacked before IOC extraction
* DLL lacked entry point â†’ executed via rundll32 install export
* Persistence suspected â†’ registry diff performed
* Behavior unclear â†’ CAPA capability mapping used
* Delay behavior observed â†’ reverse engineering confirmed

---

# Adversary Tradecraft Observed

* Packing for evasion
* Service persistence
* Registry modification
* Execution delay anti-sandbox
* Embedded document script triggers
* Beacon callback behavior

---

# Detection Engineering Opportunities

* rundll32 service install monitoring
* Registry service key alerts
* Packed binary heuristics
* PDF OpenAction scanning
* Beacon interval detection
* Mutex creation alerts
* CAPA rule automation

---

# Reproduce This Investigation

1. Load sample into REMnux
2. Run `pdfid.py`
3. Decode objects with pdf-parser
4. Inspect PE headers
5. Detect packer
6. Unpack with UPX
7. Run Pestudio
8. Capture Regshot before/after
9. Execute via rundll32
10. Capture PCAP
11. Run CAPA
12. Validate via reverse engineering

---

# Skills Demonstrated

* Static malware analysis
* PDF exploit inspection
* Packed binary unpacking
* DLL behavioral analysis
* Registry forensics
* Network IOC extraction
* Capability mapping
* MITRE ATT&CK translation
* Reverse engineering validation
* Detection engineering thinking

---

```

---

If you want, next I can generate a **repo folder + screenshot naming map** so everything aligns perfectly and renders cleanly on GitHub.
```
